import{h as H,c as G,O as te,M as le,aH as ne,aI as re,a as F,d as oe,m as a,n as P,p as s,q as u,j as J,r as x,w as N,y as se,ac as w,u as i,_ as de,z as E,A as o,B as V,F as c,t as b,ae as B,s as T,af as ie,ag as ce,Q as pe}from"./index.327b4700.js";import{$,Q as ve}from"./QInput.76567d60.js";import{d as me,S as ge,Q as fe,e as S,a as _e,b as be}from"./TableSkeleton.772c2dc2.js";import{h as ye,i as he,j as W,Q as Ce,b as U}from"./QCard.440d414a.js";import{_ as L}from"./CopyText.9704d296.js";import{Q as A}from"./QSkeleton.e61b48c4.js";import{Q as xe,a as K,b as R}from"./QItem.cb161c91.js";import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import{e as j}from"./helpers.5a00600a.js";import{M as C}from"./mode.table.8dd12f40.js";const Pe=H("div",{class:"q-space"});var Qe=G({name:"QSpace",setup(){return()=>Pe}});function z(l){if(l===!1)return 0;if(l===!0||l===void 0)return 1;const d=parseInt(l,10);return isNaN(d)?0:d}var ke=te({name:"close-popup",beforeMount(l,{value:d}){const p={depth:z(d),handler(e){p.depth!==0&&setTimeout(()=>{const y=ye(l);y!==void 0&&he(y,e,p.depth)})},handlerKey(e){le(e,13)===!0&&p.handler(e)}};l.__qclosepopup=p,l.addEventListener("click",p.handler),l.addEventListener("keyup",p.handlerKey)},updated(l,{value:d,oldValue:p}){d!==p&&(l.__qclosepopup.depth=z(d))},beforeUnmount(l){const d=l.__qclosepopup;l.removeEventListener("click",d.handler),l.removeEventListener("keyup",d.handlerKey),delete l.__qclosepopup}}),we=G({name:"QCardActions",props:{...ne,vertical:Boolean},setup(l,{slots:d}){const p=re(l),e=F(()=>`q-card__actions ${p.value} q-card__actions--${l.vertical===!0?"vert column":"horiz row"}`);return()=>H("div",{class:e.value},oe(d.default))}});const Ie={};function Ae(l,d){return a(),P(W,null,{default:s(()=>[u(xe,null,{default:s(()=>[u(K,{avatar:""},{default:s(()=>[u(A,{type:"QAvatar"})]),_:1}),u(K,null,{default:s(()=>[u(R,null,{default:s(()=>[u(A,{type:"text"})]),_:1}),u(R,{caption:""},{default:s(()=>[u(A,{type:"text"})]),_:1})]),_:1})]),_:1}),u(A,{height:"200px",square:""}),u(we,{align:"right",class:"q-gutter-md"},{default:s(()=>[u(A,{type:"QBtn"}),u(A,{type:"QBtn"})]),_:1})]),_:1})}var Fe=X(Ie,[["render",Ae],["__scopeId","data-v-9f2c4c2a"]]);const Ee={class:"text-h4"},Be=J({name:"ModalOrder",__name:"Order",props:{modelValue:{type:Boolean,default:!1},orderId:{}},emits:["update:modelValue"],setup(l,{emit:d}){const p={type:"\u0422\u0438\u043F \u0437\u0430\u043A\u0430\u0437\u0430",addressFrom:"\u041E\u0442\u043A\u0443\u0434\u0430",addressTo:"\u041A\u0443\u0434\u0430",comment:"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439",price:"\u0426\u0435\u043D\u0430",status:"\u0421\u0442\u0430\u0442\u0443\u0441",passengerId:"id \u043F\u0430\u0441\u0441\u0430\u0436\u0438\u0440\u0430",driverId:"id \u0432\u043E\u0434\u0438\u0442\u0435\u043B\u044F",city:"\u0413\u043E\u0440\u043E\u0434",submissionTime:"\u0412\u0440\u0435\u043C\u044F \u043F\u043E\u0434\u0430\u0447\u0438",commission:"\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F \u0441\u0435\u0440\u0432\u0438\u0441\u0430",createdAt:"\u0414\u0430\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F",reviews:"\u041E\u0442\u0437\u044B\u0432\u044B",appeals:"\u041E\u0431\u0440\u0430\u0449\u0435\u043D\u0438\u044F"},e=l,y=d,n=x(),Q=x(e.modelValue),k=()=>{!e.orderId||$.getFullOrderInfo(e.orderId,f=>{n.value=f},f=>console.log(f))};return N(()=>Q.value,f=>y("update:modelValue",f)),N(()=>e.modelValue,f=>Q.value=f),N(()=>e.orderId,f=>{k()}),se(()=>{k()}),(f,_)=>(a(),P(Ce,{modelValue:Q.value,"onUpdate:modelValue":_[0]||(_[0]=I=>Q.value=I)},{default:s(()=>[n.value?(a(),P(W,{key:0,class:"bg-white text-dark layout",container:"",view:"Lhh lpR fff"},{default:s(()=>[u(U,{class:"row items-center q-pb-none"},{default:s(()=>[w("div",Ee,[w("b",null,i(n.value.numberOrder),1),u(L,{text:n.value.numberOrder.toString()},null,8,["text"])]),u(Qe),de(u(E,{dense:"",flat:"",icon:"close",round:""},null,512),[[ke]])]),_:1}),u(U,null,{default:s(()=>[(a(),o(c,null,V(p,(I,t)=>w("div",{key:t,class:"table-item"},[n.value[t]?(a(),o(c,{key:0},[w("b",null,i(I)+": ",1),w("span",null,[t==="appeals"?(a(!0),o(c,{key:0},V(n.value.appeals,({numberAppeal:m})=>(a(),o("div",{key:m},[b(i(m)+" ",1),u(L,{text:m.toString()},null,8,["text"])]))),128)):t==="reviews"?(a(!0),o(c,{key:1},V(n.value.reviews,m=>(a(),o("div",{key:m.from},i(n.value.driverId===m.from?"\u041E\u0442\u0437\u044B\u0432 \u0432\u043E\u0434\u0438\u0442\u0435\u043B\u044F":"\u041E\u0442\u0437\u044B\u0432 \u043F\u0430\u0441\u0441\u0430\u0436\u0438\u0440\u0430")+": "+i(m.text),1))),128)):t==="type"?(a(),o(c,{key:2},[b(i(B(me)[n.value[t]]),1)],64)):t==="status"?(a(),o(c,{key:3},[b(i(B(ge)[n.value[t]]),1)],64)):t==="price"||t==="commission"?(a(),o(c,{key:4},[b(i(n.value[t])+" \u20BD ",1)],64)):t==="driverId"||t==="passengerId"?(a(),o(c,{key:5},[b(i(n.value[t])+" ",1),u(L,{text:n.value[t].toString()},null,8,["text"])],64)):t==="submissionTime"?(a(),o(c,{key:6},[b(i(n.value[t])+" \u043C\u0438\u043D. ",1)],64)):t==="createdAt"?(a(),o(c,{key:7},[b(i(new Date(n.value[t]).toLocaleString("ru-RU")),1)],64)):(a(),o(c,{key:8},[b(i(n.value[t]),1)],64))])],64)):T("",!0)])),64))]),_:1})]),_:1})):(a(),P(Fe,{key:1}))]),_:1},8,["modelValue"]))}});const Oe=J({__name:"TableOrder",props:{list:{default:()=>[]},hiddenFields:{default:()=>[]},pagination:{default:()=>({currentPage:1,perPageCount:10,total:0})},mode:{default:C.Page},loading:{type:Boolean,default:!1}},emits:["selectPage","update"],setup(l,{emit:d}){const p=d,e=l,y=x([]),n=x(""),Q=F(()=>Math.ceil(e.pagination.total/e.pagination.perPageCount)),k=x(!1),f=F(()=>k.value||e.loading),_=x(e.mode),I=x(""),t=x(!1),m=x(!1),Y=F(()=>e.hiddenFields.length?S.filter(g=>!e.hiddenFields.includes(g.field)):S),q=F(()=>_.value==C.Page?{rowsPerPage:e.pagination.perPageCount,page:e.pagination.currentPage,rowsNumber:Number(e.pagination.total)}:{rowsPerPage:e.pagination.perPageCount}),Z=ie(async g=>{n.value=g,k.value=!0;const h=()=>{y.value=[],_.value=e.mode,k.value=!1};if(!n.value){h();return}if(_.value===C.All&&e.mode==C.All){y.value=e.list.filter(r=>r.numberOrder.toLowerCase().includes(n.value.toLowerCase())),k.value=!1;return}await $.findByNumberOrder(n.value,r=>{_.value=C.All,y.value=r,k.value=!1},h())},700),ee=async()=>{m.value=!0,_.value===C.All?(await j(S,D.value),m.value=!1):_.value===C.Page&&$.getAllOrders(async g=>{await j(S,g.data),m.value=!1},g=>{m.value=!1,console.log(g)})},ae=g=>{I.value=g,t.value=!0},O=g=>{p("selectPage",g)},D=F(()=>n.value?y.value:e.list);return(g,h)=>(a(),o(c,null,[(a(),P(fe,{key:q.value,columns:Y.value,loading:f.value,pagination:q.value,rows:D.value,"rows-per-page-options":_.value==B(C).Page?[10]:[5,7,10,15,20,25,50,0],class:"table-order","row-key":"name",title:"\u0417\u0430\u043A\u0430\u0437\u044B"},ce({"top-left":s(()=>[u(ve,{"model-value":n.value,debounce:"300",dense:"",outlined:"",placeholder:"\u041F\u043E\u0438\u0441\u043A \u043F\u043E \u043D\u043E\u043C\u0435\u0440\u0443 \u0437\u0430\u043A\u0430\u0437\u0430",standout:"","onUpdate:modelValue":B(Z)},{append:s(()=>[u(pe,{name:"search"})]),_:1},8,["model-value","onUpdate:modelValue"])]),body:s(r=>[u(be,{props:r,class:"table-order__row",onClick:v=>{var M;return ae((M=r.cols.find(({name:ue})=>ue==="_id"))==null?void 0:M.value)}},{default:s(()=>[(a(!0),o(c,null,V(r.cols,v=>(a(),P(_e,{key:v.name,props:r},{default:s(()=>[(v.name==="numberOrder"||v.name==="passengerId"||v.name==="driverId")&&!!v.value?(a(),o(c,{key:0},[b(i(v.value)+" ",1),u(L,{text:v.value.toString()},null,8,["text"])],64)):v.name==="_id"?(a(),o(c,{key:1},[],64)):(a(),o(c,{key:2},[b(i(v.value),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props","onClick"])]),"top-right":s(()=>[u(E,{disable:!D.value.length,loading:m.value,color:"primary","icon-right":"archive",label:"\u042D\u043A\u0441\u043F\u043E\u0440\u0442 \u0432 csv","no-caps":"",onClick:ee},null,8,["disable","loading"])]),_:2},[_.value==B(C).Page?{name:"pagination",fn:s(r=>[w("b",null,i(r.pagination.page),1),b(" \xA0 \u0438\u0437\xA0 "),w("b",null,i(r.pagesNumber),1),r.pagesNumber>2?(a(),P(E,{key:0,disable:r.isFirstPage,color:"grey-8",dense:"",flat:"",icon:"first_page",round:"",onClick:h[0]||(h[0]=v=>O(1))},null,8,["disable"])):T("",!0),u(E,{disable:r.isFirstPage,color:"grey-8",dense:"",flat:"",icon:"chevron_left",round:"",onClick:v=>O(r.pagination.page<=1?1:r.pagination.page-1)},null,8,["disable","onClick"]),u(E,{disable:r.isLastPage,color:"grey-8",dense:"",flat:"",icon:"chevron_right",round:"",onClick:v=>r.pagination.page>=Q.value?Q.value:O(r.pagination.page+1)},null,8,["disable","onClick"]),r.pagesNumber>2?(a(),P(E,{key:1,disable:r.isLastPage,color:"grey-8",dense:"",flat:"",icon:"last_page",round:"",onClick:h[1]||(h[1]=v=>O(Q.value))},null,8,["disable"])):T("",!0)]),key:"0"}:void 0]),1032,["columns","loading","pagination","rows","rows-per-page-options"])),t.value?(a(),P(Be,{key:0,modelValue:t.value,"onUpdate:modelValue":h[2]||(h[2]=r=>t.value=r),"order-id":I.value},null,8,["modelValue","order-id"])):T("",!0)],64))}});var Ke=X(Oe,[["__scopeId","data-v-6bb36424"]]);export{Fe as C,Qe as Q,Ke as T,ke as a};
